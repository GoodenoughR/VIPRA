<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.10.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>VIPRA Documentation: README</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<script type="text/javascript" src="../../clipboard.js"></script>
<script type="text/javascript" src="../../cookie.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">VIPRA Documentation
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.10.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title">README</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><ul>
<li>Introduction</li>
</ul>
<p>Usage</p><ul>
<li>Simulation Construction<ul>
<li>Example Simulation</li>
<li>Example Parameter Sweep</li>
</ul>
</li>
<li>Module Parameters</li>
<li>Included Modules</li>
</ul>
<p>Common Errors</p>
<ul>
<li>Development<ul>
<li>Overview<ul>
<li>Simulation</li>
<li>Module Types</li>
<li>Parameter Sweep</li>
<li>Randomization</li>
<li>VIPRA Types</li>
</ul>
</li>
<li>Module Implementation<ul>
<li>Model Implementation</li>
<li>Goals Implementation</li>
<li>Obstacle Set Implementation</li>
<li>Pedestrian Set Implementation</li>
<li>Input Implementation</li>
<li>Output Implementation</li>
</ul>
</li>
<li>Parameter Sweep Usage</li>
<li>Macros</li>
<li>Utilities<ul>
<li>Algorithms</li>
<li>Data Structures</li>
</ul>
</li>
</ul>
</li>
</ul>
<h1><a class="anchor" id="autotoc_md54"></a>
Usage</h1>
<p>VIPRA is a template framework this means it requires the user to define their own main and handle any command line arguments.</p>
<p>A basic skeleton will be provided in the future for ease of use.</p>
<p>There is an Example Simulation below.</p>
<h2><a class="anchor" id="autotoc_md55"></a>
Simulation Construction</h2>
<p>Simulations are created by choosing which implementations to use for the several different Module Types.</p>
<p>A utility function for creating simulations is provided that allows the modules to be passed in in any order: </p><div class="fragment"><div class="line"> ++</div>
<div class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span>... module_ts&gt;</div>
<div class="line"><span class="keyword">auto</span> VIPRA::simulation(module_ts&amp;&amp;...) -&gt; <a class="code hl_class" href="../../da/d73/classVIPRA_1_1SimType.html">VIPRA::SimType</a>;</div>
<div class="ttc" id="aclassVIPRA_1_1SimType_html"><div class="ttname"><a href="../../da/d73/classVIPRA_1_1SimType.html">VIPRA::SimType</a></div><div class="ttdef"><b>Definition</b> sim_type.hpp:31</div></div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md56"></a>
Required Modules</h3>
<p>Each simulation requires the following modules:</p><ul>
<li><code>Model</code></li>
<li><code>Goals</code></li>
<li><code>Pedestrian Set</code></li>
<li><code>Map</code><ul>
<li><code>Obstacle Set</code></li>
<li><code>Polygon Input</code></li>
</ul>
</li>
<li><code>Output Coordinator</code><ul>
<li><code>Output</code></li>
</ul>
</li>
</ul>
<p><code>Maps</code> and <code>Output Coordinators</code> are special in that they require modules themselves (denoted by the additional indent)</p>
<hr  />
<h2><a class="anchor" id="autotoc_md58"></a>
Example Simulation</h2>
<p>Below is an example main that uses some of the module implementations that are shipped with VIPRA.</p>
<div class="fragment"><div class="line"> ++</div>
<div class="line"><span class="preprocessor">#include &lt;vipra.hpp&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &quot;modules/model/calm_model/calm_model.hpp&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">auto</span> main() -&gt; <span class="keywordtype">int</span> {</div>
<div class="line">  <span class="comment">// Create the simulation, modules can be placed in any order so long as all are provided/valid</span></div>
<div class="line">  <span class="keyword">auto</span> sim = VIPRA::simulation(</div>
<div class="line">      <a class="code hl_class" href="../../da/de5/classCALM_1_1Model.html">CALM::Model</a>{},                          <span class="comment">// Pedestrian Dynamics Model</span></div>
<div class="line">      <a class="code hl_class" href="../../d8/d10/classVIPRA_1_1Goals_1_1AStar.html">VIPRA::Goals::AStar</a>{},                  <span class="comment">// Goals Module</span></div>
<div class="line">      <a class="code hl_class" href="../../d8/df7/classVIPRA_1_1Pedestrians_1_1Grid.html">VIPRA::Pedestrians::Grid</a>{               <span class="comment">// Pedestrian Set Module</span></div>
<div class="line">          <a class="code hl_class" href="../../d1/d4b/classVIPRA_1_1Input_1_1JSON.html">VIPRA::Input::JSON</a>{<span class="stringliteral">&quot;maps/pedestrians/a320/a320_144_pedestrians.json&quot;</span>}, <span class="comment">// Input Module</span></div>
<div class="line">      },</div>
<div class="line">      <a class="code hl_class" href="../../d1/dd7/classVIPRA_1_1Module_1_1Output.html">VIPRA::Module::Output</a>{                  <span class="comment">// Output Coordinator</span></div>
<div class="line">        <a class="code hl_class" href="../../d1/d14/classVIPRA_1_1Output_1_1Trajectories_1_1JSON.html">VIPRA::Output::Trajectories::JSON</a>{}   <span class="comment">// Output Module</span></div>
<div class="line">      },</div>
<div class="line">      <a class="code hl_class" href="../../d2/d41/classVIPRA_1_1Module_1_1Map.html">VIPRA::Module::Map</a>{                     <span class="comment">// Map Coordinator</span></div>
<div class="line">        <a class="code hl_class" href="../../d1/d4b/classVIPRA_1_1Input_1_1JSON.html">VIPRA::Input::JSON</a>{<span class="stringliteral">&quot;maps/obstacles/a320/a320_polygons.json&quot;</span>}, <span class="comment">// Input Module (Polygon Input)</span></div>
<div class="line">        <a class="code hl_class" href="../../d7/dc5/classVIPRA_1_1Obstacles_1_1QuadTree.html">VIPRA::Obstacles::QuadTree</a>{}          <span class="comment">// Obstacle Set Module</span></div>
<div class="line">      }</div>
<div class="line">  );</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Run the simulation</span></div>
<div class="line">  sim((<a class="code hl_class" href="../../dd/d44/classVIPRA_1_1Parameters.html">VIPRA::Parameters</a>{<a class="code hl_class" href="../../d1/d4b/classVIPRA_1_1Input_1_1JSON.html">VIPRA::Input::JSON</a>{<span class="stringliteral">&quot;module_params.json&quot;</span>}}));</div>
<div class="line">}</div>
<div class="ttc" id="aclassCALM_1_1Model_html"><div class="ttname"><a href="../../da/de5/classCALM_1_1Model.html">CALM::Model</a></div><div class="ttdef"><b>Definition</b> calm_model.hpp:12</div></div>
<div class="ttc" id="aclassVIPRA_1_1Goals_1_1AStar_html"><div class="ttname"><a href="../../d8/d10/classVIPRA_1_1Goals_1_1AStar.html">VIPRA::Goals::AStar</a></div><div class="ttdoc">Goals module that uses the A* algorithm to find the path to the goal.</div><div class="ttdef"><b>Definition</b> astar_goals.hpp:30</div></div>
<div class="ttc" id="aclassVIPRA_1_1Input_1_1JSON_html"><div class="ttname"><a href="../../d1/d4b/classVIPRA_1_1Input_1_1JSON.html">VIPRA::Input::JSON</a></div><div class="ttdoc">Parameter and Polygon qualified JSON input module.</div><div class="ttdef"><b>Definition</b> json_input.hpp:38</div></div>
<div class="ttc" id="aclassVIPRA_1_1Module_1_1Map_html"><div class="ttname"><a href="../../d2/d41/classVIPRA_1_1Module_1_1Map.html">VIPRA::Module::Map</a></div><div class="ttdef"><b>Definition</b> map.hpp:20</div></div>
<div class="ttc" id="aclassVIPRA_1_1Module_1_1Output_html"><div class="ttname"><a href="../../d1/dd7/classVIPRA_1_1Module_1_1Output.html">VIPRA::Module::Output</a></div><div class="ttdef"><b>Definition</b> output.hpp:15</div></div>
<div class="ttc" id="aclassVIPRA_1_1Obstacles_1_1QuadTree_html"><div class="ttname"><a href="../../d7/dc5/classVIPRA_1_1Obstacles_1_1QuadTree.html">VIPRA::Obstacles::QuadTree</a></div><div class="ttdoc">Obstacle module that uses a quadtree to store obstacles.</div><div class="ttdef"><b>Definition</b> quad_tree.hpp:25</div></div>
<div class="ttc" id="aclassVIPRA_1_1Output_1_1Trajectories_1_1JSON_html"><div class="ttname"><a href="../../d1/d14/classVIPRA_1_1Output_1_1Trajectories_1_1JSON.html">VIPRA::Output::Trajectories::JSON</a></div><div class="ttdoc">JSON output module for writing trajectories to a JSON file.</div><div class="ttdef"><b>Definition</b> json_output.hpp:20</div></div>
<div class="ttc" id="aclassVIPRA_1_1Parameters_html"><div class="ttname"><a href="../../dd/d44/classVIPRA_1_1Parameters.html">VIPRA::Parameters</a></div><div class="ttdef"><b>Definition</b> parameters.hpp:23</div></div>
<div class="ttc" id="aclassVIPRA_1_1Pedestrians_1_1Grid_html"><div class="ttname"><a href="../../d8/df7/classVIPRA_1_1Pedestrians_1_1Grid.html">VIPRA::Pedestrians::Grid</a></div><div class="ttdoc">Pedestrian module that uses a grid to store pedestrians.</div><div class="ttdef"><b>Definition</b> grid.hpp:26</div></div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md59"></a>
Example Parameter Sweep</h2>
<p>This example uses the parameter sweep engine.</p>
<p>It takes in the total number of simulations to run as a command line argument.</p>
<div class="fragment"><div class="line"> ++</div>
<div class="line"><span class="preprocessor">#include &lt;vipra.hpp&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &quot;modules/model/calm_model/calm_model.hpp&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">auto</span> main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span>** argv) -&gt; <span class="keywordtype">int</span> {</div>
<div class="line">  VIPRA::ParameterSweep::initialize(argc, argv);  <span class="comment">// Initialize the parameter sweep engine</span></div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (argc != 2) {      <span class="comment">// Read in the command line arguments for the number of simulations to run</span></div>
<div class="line">    std::cerr &lt;&lt; <span class="stringliteral">&quot;Usage: &quot;</span> &lt;&lt; argv[0] &lt;&lt; <span class="stringliteral">&quot; &lt;simCount&gt;&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">    <span class="keywordflow">return</span> 1;</div>
<div class="line">  }</div>
<div class="line">  <span class="keywordtype">size_t</span> simCount = std::stoul(argv[1]);</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> sim = VIPRA::simulation(     <span class="comment">// Create the simulation</span></div>
<div class="line">      <a class="code hl_class" href="../../da/de5/classCALM_1_1Model.html">CALM::Model</a>{}, </div>
<div class="line">      <a class="code hl_class" href="../../d8/d10/classVIPRA_1_1Goals_1_1AStar.html">VIPRA::Goals::AStar</a>{},</div>
<div class="line">      <a class="code hl_class" href="../../d8/df7/classVIPRA_1_1Pedestrians_1_1Grid.html">VIPRA::Pedestrians::Grid</a>{</div>
<div class="line">          <a class="code hl_class" href="../../d1/d4b/classVIPRA_1_1Input_1_1JSON.html">VIPRA::Input::JSON</a>{<span class="stringliteral">&quot;maps/pedestrians/a320/a320_144_pedestrians.json&quot;</span>},</div>
<div class="line">      },</div>
<div class="line">      <a class="code hl_class" href="../../d1/dd7/classVIPRA_1_1Module_1_1Output.html">VIPRA::Module::Output</a>{<a class="code hl_class" href="../../d1/d14/classVIPRA_1_1Output_1_1Trajectories_1_1JSON.html">VIPRA::Output::Trajectories::JSON</a>{}},</div>
<div class="line">      <a class="code hl_class" href="../../d2/d41/classVIPRA_1_1Module_1_1Map.html">VIPRA::Module::Map</a>{</div>
<div class="line">        <a class="code hl_class" href="../../d1/d4b/classVIPRA_1_1Input_1_1JSON.html">VIPRA::Input::JSON</a>{<span class="stringliteral">&quot;maps/obstacles/a320/a320_polygons.json&quot;</span>},</div>
<div class="line">        <a class="code hl_class" href="../../d7/dc5/classVIPRA_1_1Obstacles_1_1QuadTree.html">VIPRA::Obstacles::QuadTree</a>{}</div>
<div class="line">      });</div>
<div class="line"> </div>
<div class="line">  VIPRA::ParameterSweep::run(    <span class="comment">// Run a parameter sweep</span></div>
<div class="line">      sim,                       <span class="comment">// Simulation to run</span></div>
<div class="line">      <a class="code hl_class" href="../../dd/d44/classVIPRA_1_1Parameters.html">VIPRA::Parameters</a>{<a class="code hl_class" href="../../d1/d4b/classVIPRA_1_1Input_1_1JSON.html">VIPRA::Input::JSON</a>{<span class="stringliteral">&quot;module_params.json&quot;</span>}}, <span class="comment">// Module Parameters</span></div>
<div class="line">      simCount,                  <span class="comment">// Number of simulations</span></div>
<div class="line">      []() { std::cout &lt;&lt; <span class="stringliteral">&quot;Simulation complete on: &quot;</span> &lt;&lt; VIPRA::ParameterSweep::get_rank() &lt;&lt; std::endl; } <span class="comment">// Optional: callback for each simulation run</span></div>
<div class="line">  );</div>
<div class="line">}</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md60"></a>
Module Parameters</h2>
<p>Parameters are loaded into each module before they are initizalized. The exact steps are showing in `Simluation Steps`.</p>
<p>Parameters can use any `Parameter Input` module, by default a `JSON` input module is provided.</p>
<p>The format for which is: </p><div class="fragment"><div class="line">{</div>
<div class="line">  &quot;module type&quot;: {</div>
<div class="line">    &quot;module name&quot;: {</div>
<div class="line">      &quot;parameter name&quot;: &quot;parameter value&quot;</div>
<div class="line">    }</div>
<div class="line">  },</div>
<div class="line">  ...</div>
<div class="line">}</div>
</div><!-- fragment --><div class="fragment"><div class="line">{</div>
<div class="line">  ...</div>
<div class="line">  &quot;goals&quot;: {                  // Module Type</div>
<div class="line">    &quot;astar&quot;: {                // Module Name</div>
<div class="line">      &quot;endGoalType&quot;: &quot;exit&quot;,  // Parameter values</div>
<div class="line">      &quot;gridSize&quot;: 0.1,</div>
<div class="line">      &quot;closestObstacle&quot;: 0.25,</div>
<div class="line">      &quot;goalRange&quot;: 0.05</div>
<div class="line">    }</div>
<div class="line">  },</div>
<div class="line">  ...</div>
<div class="line">}</div>
</div><!-- fragment --> <hr  />
<h2><a class="anchor" id="autotoc_md62"></a>
Included Modules</h2>
<p>There are several base modules included with VIPRA.</p>
<p><b>Model</b>:</p><ul>
<li>`Calm Model`</li>
</ul>
<p><b>Goals</b>:</p><ul>
<li>`AStar`</li>
</ul>
<p><b>Obstacle Set</b>:</p><ul>
<li>`QuadTree`</li>
</ul>
<p><b>Pedestrian Set</b>:</p><ul>
<li>`Grid`</li>
</ul>
<p><b>Input</b>:</p><ul>
<li>`JSON`</li>
</ul>
<p><b>Output</b>:</p><ul>
<li>`JSON`</li>
</ul>
<hr  />
<h3><a class="anchor" id="autotoc_md64"></a>
Calm Model</h3>
<p>This <code>Model</code> module implements the <a href="https://journals.plos.org/plosone/article?id=10.1371/journal.pone.0229690">Calm Model</a></p>
<h4><a class="anchor" id="autotoc_md65"></a>
Use:</h4>
<div class="fragment"><div class="line"> ++</div>
<div class="line"><span class="preprocessor">#include &quot;modules/model/calm_model/calm_model.hpp&quot;</span></div>
<div class="line"> </div>
<div class="line">VIPRA::simulation(</div>
<div class="line">  ...</div>
<div class="line">  <a class="code hl_class" href="../../da/de5/classCALM_1_1Model.html">CALM::Model</a>{},</div>
<div class="line">  ...</div>
<div class="line">);</div>
</div><!-- fragment --><h4><a class="anchor" id="autotoc_md66"></a>
Parameters:</h4>
<ul>
<li><code>meanMass</code> : Mean mass for population</li>
<li><code>massStdDev</code> : Standard Deviation for mass</li>
<li><code>meanReactionTime</code> : Mean reaction time for population</li>
<li><code>reactionTimeStdDev</code> : Standard Deviation for reaction time</li>
<li><code>meanMaxSpeed</code> : Mean max speed for population</li>
<li><code>maxSpeedStdDev</code> : Standard deviation for max speed</li>
<li><code>meanShoulderLen</code> : Mean shoulder length for population</li>
<li><code>shoulderLenStdDev</code> : Standard deviation for shoulder length</li>
</ul>
<h3><a class="anchor" id="autotoc_md67"></a>
AStar Goals</h3>
<p>This <code>Goals</code> module uses the A* algorithm to find paths for each pedestrian.</p>
<h4><a class="anchor" id="autotoc_md68"></a>
Use:</h4>
<div class="fragment"><div class="line"> ++</div>
<div class="line"><span class="preprocessor">#include &quot;vipra.hpp&quot;</span></div>
<div class="line"> </div>
<div class="line">VIPRA::simulation(</div>
<div class="line">  ...</div>
<div class="line">  <a class="code hl_class" href="../../d8/d10/classVIPRA_1_1Goals_1_1AStar.html">VIPRA::Goals::AStar</a>{},</div>
<div class="line">  ...</div>
<div class="line">);</div>
</div><!-- fragment --><h4><a class="anchor" id="autotoc_md69"></a>
Parameters:</h4>
<ul>
<li><code>endGoalType</code> : Name of object in map each pedestrian tries to reach (e.g. "exit")</li>
<li><code>goalRange</code> : Range, in meters, before a goal is counted as "reached" (e.g. 0.05)</li>
<li><code>gridSize</code> : Length of each side, in meters, of each grid in the pathing graph (e.g. 0.1)</li>
<li><code>closestObstacle</code> : Closest a grid center can be to an obstacle before being considered non-traversable</li>
</ul>
<h3><a class="anchor" id="autotoc_md70"></a>
QuadTree Obstalce Set</h3>
<p>This <code>Obstacle Set</code> module uses the Quad Tree to hold the map geometry.</p>
<h4><a class="anchor" id="autotoc_md71"></a>
Use:</h4>
<div class="fragment"><div class="line"> ++</div>
<div class="line"><span class="preprocessor">#include &quot;vipra.hpp&quot;</span></div>
<div class="line"> </div>
<div class="line">VIPRA::simulation(</div>
<div class="line">  ...</div>
<div class="line">  <a class="code hl_class" href="../../d2/d41/classVIPRA_1_1Module_1_1Map.html">VIPRA::Module::Map</a>{</div>
<div class="line">    ...</div>
<div class="line">    <a class="code hl_class" href="../../d7/dc5/classVIPRA_1_1Obstacles_1_1QuadTree.html">VIPRA::Obstacles::QuadTree</a>{} <span class="comment">// Obstacle sets go inside the Map module</span></div>
<div class="line">    ...</div>
<div class="line">  }</div>
<div class="line">  ...</div>
<div class="line">)</div>
</div><!-- fragment --><h4><a class="anchor" id="autotoc_md72"></a>
Parameters:</h4>
<ul>
<li><code>minQuadSize</code> : Size at which quads stop being subdivided</li>
</ul>
<h3><a class="anchor" id="autotoc_md73"></a>
Grid Pedestrian Set</h3>
<p>This <code>Pedestrian Set</code> module holds pedestrians in a grid of cells, allowing for more efficient lookup of nearest neighbors</p>
<h4><a class="anchor" id="autotoc_md74"></a>
Use:</h4>
<div class="fragment"><div class="line"> ++</div>
<div class="line"><span class="preprocessor">#include &quot;vipra.hpp&quot;</span></div>
<div class="line"> </div>
<div class="line">VIPRA::simulation(</div>
<div class="line">  ...</div>
<div class="line">  <a class="code hl_class" href="../../d8/df7/classVIPRA_1_1Pedestrians_1_1Grid.html">VIPRA::Pedestrians::Grid</a>{},</div>
<div class="line">  ...</div>
<div class="line">);</div>
</div><!-- fragment --><h4><a class="anchor" id="autotoc_md75"></a>
Parameters:</h4>
<ul>
<li><code>gridSize</code>: Size of each grid cell</li>
</ul>
<h3><a class="anchor" id="autotoc_md76"></a>
JSON Input</h3>
<p>This <code>Input</code> module loads JSON data, using <a href="https://github.com/nlohmann/json">nlohmann JSON</a>.</p><ul>
<li>Qualifies as a:<ul>
<li>Polygon Input</li>
<li>Parameter Input</li>
</ul>
</li>
</ul>
<h4><a class="anchor" id="autotoc_md77"></a>
Use:</h4>
<div class="fragment"><div class="line"> ++</div>
<div class="line"><span class="preprocessor">#include &quot;vipra.hpp&quot;</span></div>
<div class="line"> </div>
<div class="line">VIPRA::simulation(</div>
<div class="line">  ...</div>
<div class="line">  <a class="code hl_class" href="../../d2/d41/classVIPRA_1_1Module_1_1Map.html">VIPRA::Module::Map</a> {</div>
<div class="line">    <a class="code hl_class" href="../../d1/d4b/classVIPRA_1_1Input_1_1JSON.html">VIPRA::Input::JSON</a>{<span class="stringliteral">&quot;filepath&quot;</span>} <span class="comment">// Input modules are usually used in other modules</span></div>
<div class="line">    ...</div>
<div class="line">  }</div>
<div class="line">);</div>
<div class="line"> </div>
<div class="line">sim(<a class="code hl_class" href="../../dd/d44/classVIPRA_1_1Parameters.html">VIPRA::Parameters</a>{</div>
<div class="line">  <a class="code hl_class" href="../../d1/d4b/classVIPRA_1_1Input_1_1JSON.html">VIPRA::Input::JSON</a>{<span class="stringliteral">&quot;filepath&quot;</span>} <span class="comment">// Or for loading parameters</span></div>
<div class="line">});</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md78"></a>
JSON Output</h3>
<hr  />
<h1><a class="anchor" id="autotoc_md80"></a>
Common Errors</h1>
<hr  />
<h1><a class="anchor" id="autotoc_md82"></a>
Development</h1>
<h1><a class="anchor" id="autotoc_md83"></a>
Overview</h1>
<h2><a class="anchor" id="autotoc_md84"></a>
Simulation</h2>
<h3><a class="anchor" id="autotoc_md85"></a>
Simulation Steps</h3>
<h2><a class="anchor" id="autotoc_md86"></a>
Module Types</h2>
<p><b>Model</b></p>
<p>`Model` modules are the pedestrian dynamics models that govern how the pedestrians will move during a simulation</p>
<p><b>Goals</b></p>
<p>`Goals` modules handle pathfinding for the simulation</p>
<p><b>Obstacle Set</b></p>
<p>`Obstacle Set` modules hold the geometry of the environment and handle map/pedestrian collision detection</p>
<p><b>Pedestrian Set</b></p>
<p>`Pedestrian Set` modules hold the pedestrian positions/velocities and handle queries to pedestrians (ex. nearest neighbor)</p>
<p><b>Input</b></p>
<p>`Input` modules handle loading input for the simulation. There are several specialized input types:</p><ul>
<li>`Serializable Input` modules are inputs that allow for serialization of their values</li>
<li>`Parameter Input` modules are able to load parameters</li>
<li>`Polygon Input` modules are able to load polygons for use in obstacle sets</li>
</ul>
<p><b>Output</b></p>
<p>`Output` modules handle producing output from the simulation</p>
<p><b>Map</b></p>
<p>The `Map` module is a coordinator, it accepts one `Obstacle Set` and one `Polygon Input`.</p>
<p><b>Output Coordinator</b></p>
<p>The `Output Coordinator` module handles coordinating any number of `Output` modules.</p>
<h2><a class="anchor" id="autotoc_md87"></a>
Parameter Sweep</h2>
<h2><a class="anchor" id="autotoc_md88"></a>
Randomization</h2>
<h2><a class="anchor" id="autotoc_md89"></a>
VIPRA Types</h2>
<h1><a class="anchor" id="autotoc_md90"></a>
Module Implementation</h1>
<blockquote class="doxtable">
<p>&zwj;!!! Important Notes:</p><ul>
<li>These modules are implemented using templates; this means that any method that accepts a module as a parameter is required to be defined in a header file</li>
<li>Every module has helper macros for their required methods, see Macros </li>
</ul>
</blockquote>
<h1><a class="anchor" id="autotoc_md91"></a>
Base Module Implementation</h1>
<h3><a class="anchor" id="autotoc_md92"></a>
Interface</h3>
<div class="fragment"><div class="line"> ++</div>
<div class="line"><span class="keywordtype">void</span> register_params(Params <span class="keyword">auto</span>&amp;);</div>
<div class="line"><span class="keywordtype">void</span> config(Params <span class="keyword">auto</span> <span class="keyword">const</span>&amp;);</div>
</div><!-- fragment --><p>Every Module also requires a name and type tag:</p>
<div class="fragment"><div class="line"> ++</div>
<div class="line">VIPRA_MODULE_NAME(<span class="stringliteral">&quot;**name**&quot;</span>)</div>
<div class="line">VIPRA_MODULE_TYPE(**type**)</div>
</div><!-- fragment --><ul>
<li>Replace <code>**name**</code> with the name for the module; this will be used to pull the correct parameters from input.</li>
<li>Replace <code>**type**</code> with the type of module the class is; available modules are below:</li>
</ul>
<ol type="1">
<li><code>MODEL</code> - Model</li>
<li><code>GOALS</code> - Goals</li>
<li><code>PEDESTRIANS</code> - Pedestrian Set</li>
<li><code>OBSTACLES</code> - Obstacle Set</li>
<li><code>INPUT</code> - Input</li>
<li><code>OUTPUT</code> - Output</li>
</ol>
<h1><a class="anchor" id="autotoc_md93"></a>
Model Implementation</h1>
<p><code>Model</code> modules are the pedestrian dynamics models that govern how the pedestrians will move during a simulation</p>
<h3><a class="anchor" id="autotoc_md94"></a>
Interface</h3>
<p>Along with the Base Module interface, Model modules are required to implement the following methods.</p>
<p>Helper macros can be found in Model Macros</p>
<div class="fragment"><div class="line"> ++</div>
<div class="line"><span class="keywordtype">void</span> initialize(PedSet <span class="keyword">auto</span> <span class="keyword">const</span>&amp;, Map <span class="keyword">auto</span> <span class="keyword">const</span>&amp;, Goals <span class="keyword">auto</span> <span class="keyword">const</span>&amp;, Output <span class="keyword">auto</span>&amp;);</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> timestep(PedSet <span class="keyword">auto</span> <span class="keyword">const</span>&amp;, Map <span class="keyword">auto</span> <span class="keyword">const</span>&amp;, Goals <span class="keyword">auto</span> <span class="keyword">const</span>&amp;, Output <span class="keyword">auto</span>&amp;, <a class="code hl_struct" href="../../d4/da2/structVIPRA_1_1State.html">VIPRA::State</a>&amp;, VIPRA::delta_t, VIPRA::timestep);</div>
<div class="ttc" id="astructVIPRA_1_1State_html"><div class="ttname"><a href="../../d4/da2/structVIPRA_1_1State.html">VIPRA::State</a></div><div class="ttdoc">Struct that holds the updated positions and velocities of all pedestrians.</div><div class="ttdef"><b>Definition</b> state.hpp:13</div></div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md95"></a>
Goals Implementation</h1>
<p><code>Goals</code> modules handle pathfinding for the simulation.</p>
<h3><a class="anchor" id="autotoc_md96"></a>
Interface</h3>
<p>Along with the Base Module interface, Goals modules are required to implement the following methods.</p>
<p>Helper macros can be found in Goals Macros</p>
<div class="fragment"><div class="line"> ++</div>
<div class="line"><span class="keywordtype">void</span> initialize(PedSet <span class="keyword">auto</span> <span class="keyword">const</span>&amp;, Map <span class="keyword">auto</span> <span class="keyword">const</span>&amp;);</div>
<div class="line"><span class="keywordtype">void</span> update(PedSet <span class="keyword">auto</span> <span class="keyword">const</span>&amp;, Map <span class="keyword">auto</span> <span class="keyword">const</span>&amp;, VIPRA::delta_t);</div>
<div class="line"><span class="keywordtype">void</span> change_end_goal(VIPRA::idx, <a class="code hl_struct" href="../../d8/d28/structVIPRA_1_1f3d.html">VIPRA::f3d</a>);</div>
<div class="line"> </div>
<div class="line"><span class="keyword">auto</span> current_goals() -&gt; std::vector&lt;VIPRA::f3d&gt; <span class="keyword">const</span>&amp;;</div>
<div class="line"><span class="keyword">auto</span> end_goals() -&gt; std::vector&lt;VIPRA::f3d&gt; <span class="keyword">const</span>&amp;;</div>
<div class="line"><span class="keyword">auto</span> current_goal(VIPRA::idx) -&gt; <a class="code hl_struct" href="../../d8/d28/structVIPRA_1_1f3d.html">VIPRA::f3d</a> <span class="keyword">const</span>&amp;;</div>
<div class="line"><span class="keyword">auto</span> end_goal(VIPRA::idx) -&gt; <a class="code hl_struct" href="../../d8/d28/structVIPRA_1_1f3d.html">VIPRA::f3d</a> <span class="keyword">const</span>&amp;;</div>
<div class="line"><span class="keyword">auto</span> is_goal_met(VIPRA::idx) -&gt; bool;</div>
<div class="line"><span class="keyword">auto</span> is_sim_goal_met() -&gt; bool;</div>
<div class="line"><span class="keyword">auto</span> time_since_last_goal(VIPRA::idx) -&gt; VIPRA::f_pnt;</div>
<div class="ttc" id="astructVIPRA_1_1f3d_html"><div class="ttname"><a href="../../d8/d28/structVIPRA_1_1f3d.html">VIPRA::f3d</a></div><div class="ttdef"><b>Definition</b> f3d.hpp:18</div></div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md97"></a>
Obstacle Set Implementation</h1>
<p>Obstacle Set modules hold the geometry of the environment and handle map/pedestrian collision detection.</p>
<h3><a class="anchor" id="autotoc_md98"></a>
Interface</h3>
<p>Along with the Base Module interface, Obstacle Set modules are required to implement the following methods.</p>
<p>Helper macros can be found in Obstacle Set Macros</p>
<div class="fragment"><div class="line"> ++</div>
<div class="line"><span class="keywordtype">void</span> initialize(std::vector&lt;VIPRA::Geometry::Polygon&gt; <span class="keyword">const</span>&amp;, std::vector&lt;std::string&gt; <span class="keyword">const</span>&amp;, std::map&lt;std::string, std::vector&lt;VIPRA::f3d&gt;&gt; <span class="keyword">const</span>&amp;);</div>
<div class="line"> </div>
<div class="line"><span class="keyword">auto</span> get_object_types() -&gt; std::vector&lt;std::string&gt; <span class="keyword">const</span>&amp;;</div>
<div class="line"><span class="keyword">auto</span> get_objects(std::string <span class="keyword">const</span>&amp;) -&gt; std::vector&lt;VIPRA::f3d&gt; <span class="keyword">const</span>&amp;;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">auto</span> collision(VIPRA:f3d) -&gt; bool;</div>
<div class="line"><span class="keyword">auto</span> collision(<a class="code hl_class" href="../../de/df6/classVIPRA_1_1Geometry_1_1Circle.html">VIPRA::Geometry::Circle</a>) -&gt; bool;</div>
<div class="line"><span class="keyword">auto</span> ray_hit(<a class="code hl_struct" href="../../d8/d28/structVIPRA_1_1f3d.html">VIPRA::f3d</a>, <a class="code hl_struct" href="../../d8/d28/structVIPRA_1_1f3d.html">VIPRA::f3d</a>) -&gt; VIPRA::f_pnt;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">auto</span> get_dimensions() -&gt; <a class="code hl_struct" href="../../d8/d28/structVIPRA_1_1f3d.html">VIPRA::f3d</a>;</div>
<div class="ttc" id="aclassVIPRA_1_1Geometry_1_1Circle_html"><div class="ttname"><a href="../../de/df6/classVIPRA_1_1Geometry_1_1Circle.html">VIPRA::Geometry::Circle</a></div><div class="ttdef"><b>Definition</b> circle.hpp:7</div></div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md99"></a>
Pedestrian Set Implementation</h1>
<h3><a class="anchor" id="autotoc_md100"></a>
Interface</h3>
<p>Along with the Base Module interface, Obstacle Set modules are required to implement the following methods.</p>
<p>Helper macros can be found in Pedestrian Set Macros</p>
<div class="fragment"><div class="line"> ++</div>
<div class="line"><span class="keyword">auto</span> num_pedestrians() -&gt; VIPRA::size;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">auto</span> ped_coords(VIPRA::idx) -&gt; <a class="code hl_struct" href="../../d8/d28/structVIPRA_1_1f3d.html">VIPRA::f3d</a>;</div>
<div class="line"><span class="keyword">auto</span> all_coords() -&gt; std::vector&lt;VIPRA::f3d&gt; <span class="keyword">const</span>&amp;;</div>
<div class="line"><span class="keyword">auto</span> ped_velocity(VIPRA::idx) -&gt; <a class="code hl_struct" href="../../d8/d28/structVIPRA_1_1f3d.html">VIPRA::f3d</a>;</div>
<div class="line"><span class="keyword">auto</span> all_velocities() -&gt; std::vector&lt;VIPRA::f3d&gt; <span class="keyword">const</span>&amp;;</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> update(<a class="code hl_struct" href="../../d4/da2/structVIPRA_1_1State.html">VIPRA::State</a> <span class="keyword">const</span>&amp;);</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md101"></a>
Input Implementation</h1>
<blockquote class="doxtable">
<p>&zwj;!!! Important Note: Inputs should hold off on loading their input until their <code>load</code> method is called. This reduces the amount of I/O during parallel runs. </p>
</blockquote>
<h3><a class="anchor" id="autotoc_md102"></a>
Interface</h3>
<p>Along with the Base Module interface, Input modules are required to implement the following methods.</p>
<div class="fragment"><div class="line"> ++</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> load();</div>
<div class="line"> </div>
<div class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> data_t, <span class="keyword">typename</span>... key_ts&gt;</div>
<div class="line"><span class="keyword">auto</span> get(key_ts <span class="keyword">const</span>&amp;...) -&gt; data_t;</div>
</div><!-- fragment --><h4><a class="anchor" id="autotoc_md103"></a>
Serializable Input Implementation</h4>
<p>Serializable Input modules additionally require:</p>
<div class="fragment"><div class="line"> ++</div>
<div class="line"><span class="keyword">auto</span> serialize() -&gt; std::string;</div>
<div class="line"><span class="keywordtype">void</span> deserialize(std::string <span class="keyword">const</span>&amp;);</div>
</div><!-- fragment --><h4><a class="anchor" id="autotoc_md104"></a>
Parameter Input Implementation</h4>
<p>Parameter Input modules additionally require:</p>
<div class="fragment"><div class="line"> ++</div>
<div class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> data_t, <span class="keyword">typename</span>... key_ts&gt;</div>
<div class="line"><span class="keyword">auto</span> get&lt;VIPRA::Parameter&lt;data_t&gt;&gt;(key_ts <span class="keyword">const</span>&amp;...) -&gt; std::optional&lt;VIPRA::Parameter&lt;data_t&gt;&gt;;</div>
</div><!-- fragment --><h4><a class="anchor" id="autotoc_md105"></a>
Polygon Input Implementation</h4>
<p>Polygon Input modules additionally require:</p>
<div class="fragment"><div class="line"> ++</div>
<div class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span>... key_ts&gt;</div>
<div class="line"><span class="keyword">auto</span> load_polygons(key_ts <span class="keyword">const</span>&amp;...) -&gt; std::optional&lt;std::vector&lt;VIPRA::Geometry::Polygon&gt;&gt;;</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md106"></a>
Output Implementation</h1>
<h3><a class="anchor" id="autotoc_md107"></a>
Interface</h3>
<p>Along with the Base Module interface, Output modules are required to implement the following methods.</p>
<p>Helper macros can be found in Output Macros</p>
<div class="fragment"><div class="line"> ++</div>
<div class="line"><span class="keyword">auto</span> write();</div>
<div class="line"> </div>
<div class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> value_t&gt;</div>
<div class="line"><span class="keywordtype">void</span> timestep_value(std::string <span class="keyword">const</span>&amp;, VIPRA::timestep, value_t);</div>
<div class="line"> </div>
<div class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> value_t&gt;</div>
<div class="line"><span class="keywordtype">void</span> ped_timestep_value(VIPRA::idx, VIPRA::timestep, std::string <span class="keyword">const</span>&amp;, value_t);</div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.10.0
</small></address>
</body>
</html>
